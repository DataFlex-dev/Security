//* -- IETF ChaCha20-Poly1305 construction with a 96-bit nonce and a 32-bit internal counter -- */

Define crypto_aead_chacha20poly1305_ietf_KEYBYTES for 32

#IFNDEF sLibsodiumDllName
#IFDEF IS$WIN64
  Define sLibsodiumDllName for libsodium64.dll
#ELSE
  Define sLibsodiumDllName for libsodium.dll
#ENDIF 
#ENDIF

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_ietf_keybytes "crypto_aead_chacha20poly1305_ietf_keybytes" sLibsodiumDllName ;
    Returns UInteger

Define crypto_aead_chacha20poly1305_ietf_NSECBYTES for 0

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_ietf_nsecbytes "crypto_aead_chacha20poly1305_ietf_nsecbytes" sLibsodiumDllName ;
    Returns UInteger

Define crypto_aead_chacha20poly1305_ietf_NPUBBYTES for 12

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_ietf_npubbytes "crypto_aead_chacha20poly1305_ietf_npubbytes" sLibsodiumDllName ;
    Returns UInteger

Define crypto_aead_chacha20poly1305_ietf_ABYTES for 16

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_ietf_abytes "crypto_aead_chacha20poly1305_ietf_abytes" sLibsodiumDllName ;
    Returns UInteger

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_ietf_encrypt "crypto_aead_chacha20poly1305_ietf_encrypt" sLibsodiumDllName ;
    Pointer  c ;
    Pointer  clen_p ;
    Pointer  m ;
    BigInt   mlen ;
    Pointer  ad ;
    BigInt   adlen ;
    Pointer  nsec ;
    Pointer  npub ;
    Pointer  k ;
    Returns  Integer

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_ietf_decrypt "crypto_aead_chacha20poly1305_ietf_decrypt" sLibsodiumDllName ;
    Pointer  m ;
    Pointer  mlen_p ;
    Pointer  nsec ;
    Pointer  c ;
    BigInt   clen ;
    Pointer  ad ;
    BigInt   adlen ;
    Pointer  npub ;
    Pointer  k ;
    Returns  Integer

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_ietf_encrypt_detached "crypto_aead_chacha20poly1305_ietf_encrypt_detached" sLibsodiumDllName ;
    Pointer  c ;
    Pointer  mac ;
    Pointer  maclen_p ;
    Pointer  m ;
    BigInt   mlen ;
    Pointer  ad ;
    BigInt   adlen ;
    Pointer  nsec ;
    Pointer  npub ;
    Pointer  k ;
    Returns  Integer

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_ietf_decrypt_detached "crypto_aead_chacha20poly1305_ietf_decrypt_detached" sLibsodiumDllName ;
    Pointer  m ;
    Pointer  nsec ;
    Pointer  c ;
    BigInt   clen ;
    Pointer  mac ;
    Pointer  ad ;
    BigInt   adlen ;
    Pointer  npub ;
    Pointer  k ;
    Returns  Integer

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_ietf_keygen "crypto_aead_chacha20poly1305_ietf_keygen" sLibsodiumDllName ;
    Pointer k;      // length: crypto_aead_chacha20poly1305_ietf_KEYBYTES
    Returns Void_Type

//* -- Original ChaCha20-Poly1305 construction with a 64-bit nonce and a 64-bit internal counter -- */

Define crypto_aead_chacha20poly1305_KEYBYTES for 32

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_keybytes "crypto_aead_chacha20poly1305_keybytes" sLibsodiumDllName ;
    Returns UInteger

Define crypto_aead_chacha20poly1305_NSECBYTES for 0

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_nsecbytes "crypto_aead_chacha20poly1305_nsecbytes" sLibsodiumDllName ;
    Returns UInteger

Define crypto_aead_chacha20poly1305_NPUBBYTES for 8

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_npubbytes "crypto_aead_chacha20poly1305_npubbytes" sLibsodiumDllName ;
    Returns UInteger

Define crypto_aead_chacha20poly1305_ABYTES for 16

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_abytes "crypto_aead_chacha20poly1305_abytes" sLibsodiumDllName ;
    Returns UInteger

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_encrypt "crypto_aead_chacha20poly1305_encrypt" sLibsodiumDllName ;
    Pointer  c ;
    Pointer  clen_p ;
    Pointer  m ;
    BigInt   mlen ;
    Pointer  ad ;
    BigInt   adlen ;
    Pointer  nsec ;
    Pointer  npub ;
    Pointer  k ;
    Returns  Integer

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_decrypt "crypto_aead_chacha20poly1305_decrypt" sLibsodiumDllName ;
    Pointer  m ;
    Pointer  mlen_p ;
    Pointer  nsec ;
    Pointer  c ;
    BigInt   clen ;
    Pointer  ad ;
    BigInt   adlen ;
    Pointer  npub ;
    Pointer  k ;
    Returns  Integer

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_encrypt_detached "crypto_aead_chacha20poly1305_encrypt_detached" sLibsodiumDllName ;
    Pointer  c ;
    Pointer  mac ;
    Pointer  maclen_p ;
    Pointer  m ;
    BigInt   mlen ;
    Pointer  ad ;
    BigInt   adlen ;
    Pointer  nsec ;
    Pointer  npub ;
    Pointer  k ;
    Returns  Integer

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_decrypt_detached "crypto_aead_chacha20poly1305_decrypt_detached" sLibsodiumDllName ;
    Pointer  m ;
    Pointer  nsec ;
    Pointer  c ;
    BigInt   clen ;
    Pointer  mac ;
    Pointer  ad ;
    BigInt   adlen ;
    Pointer  npub ;
    Pointer  k ;
    Returns  Integer

{ Visibility=Private }
External_Function libsodium_crypto_aead_chacha20poly1305_keygen "crypto_aead_chacha20poly1305_keygen" sLibsodiumDllName ;
    Pointer k;      // length: crypto_aead_chacha20poly1305_KEYBYTES
    Returns Void_Type

//* Aliases */

Define crypto_aead_chacha20poly1305_IETF_KEYBYTES  for crypto_aead_chacha20poly1305_ietf_KEYBYTES
Define crypto_aead_chacha20poly1305_IETF_NSECBYTES for crypto_aead_chacha20poly1305_ietf_NSECBYTES
Define crypto_aead_chacha20poly1305_IETF_NPUBBYTES for crypto_aead_chacha20poly1305_ietf_NPUBBYTES
Define crypto_aead_chacha20poly1305_IETF_ABYTES    for crypto_aead_chacha20poly1305_ietf_ABYTES

